<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="LMD">
<title>Getting Started with LMD • LMD</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with LMD">
<meta property="og:description" content="LMD">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">LMD</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Getting_Started_with_LMD.html">Getting Started with LMD</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/shubhra-opensource/LMD/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Getting Started with LMD</h1>
                        <h4 data-toc-skip class="author">Shubhra
Prakash</h4>
            
            <h4 data-toc-skip class="date">2023-05-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/shubhra-opensource/LMD/blob/HEAD/vignettes/Getting_Started_with_LMD.Rmd" class="external-link"><code>vignettes/Getting_Started_with_LMD.Rmd</code></a></small>
      <div class="d-none name"><code>Getting_Started_with_LMD.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<div style="text-align: justify">
<p>The R package LMD is introduced in this work, which is based on local
mean decomposition, an iterative and self-adaptive approach for
demodulating, processing, and analyzing multi-component
amplitude-modulated (AM) and frequency modulated (FM) signals. Any
complex signal can be decomposed into product functions (PFs) using LMD,
where each PF is the product of an envelope signal and a purely
frequency modulated signal (FM). The LMD method can be used to a broad
variety of natural signals, including electrocardiograms and seismic
data. In addition, because equipment fault vibration signals are
frequently multi-component modulation signals, LMD may be used to
identify faults in gears, roller bearings, and other rotating machinery.
The LMD package includes utilities for calculating extreme points and
moving averages. LMD as a package includes functions for finding extreme
points, moving average smoothing, checking monotonicity, extracting mean
and envelope signals, extracting product functions and graphical display
of results. In this vignette we will cover the mentioned functions for
experimental analysis of a simulated signal to show the validity of the
LMD method.</p>
</div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div style="text-align: justify">
<p>Rotating machines are widely used in many sectors and are susceptible
to a wide range of failures, particularly when working in tough and
time-varying situations. Early discovery of these faults is critical;
otherwise, they may result in significant economic loss, if not a
catastrophe. As a result, the development of effective defect diagnostic
techniques is critical for safety and improved maintenance decision
making in rotating equipment applications. There are many feature
extraction techniques available today for the detection of rotating
machinery faults, such as frequency/spectrum analysis, time/statistical
analysis, time-frequency analysis, and so on. However, the approaches
described above are only applicable to mono-component modulation
signals, and also do not perform well for non-stationary signals.<br>  
Signals acquired from machines not only have the frequency of the
machine component of interest, but also interference frequencies from
other neighboring components and environmental disturbances. The
phenomena of amplitude modulation, frequency modulation, and phase
modulation are also frequent in these signals. Furthermore, rotating
machines frequently operate under time-varying speed and load
circumstances, causing the signals obtained from them to be non-linear.
If a failure starts developing in these machines, the fault signature is
difficult to identify owing to the interferences indicated above.<br>  
Adaptive mode decomposition approaches work well with non-stationary
time series data. These procedures do not need any prior understanding
of the signals and are good in capturing the local features of a signal,
such as malfunction indication. LMD is also an adaptive technique that
can decompose a complex multi-component signal into a series of product
functions (PFs) on its own.</p>
</div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="lmd">LMD<a class="anchor" aria-label="anchor" href="#lmd"></a>
</h2>
<div style="text-align: justify">
<p>A multi-component signal can be broken down into its constituent PFs
and a residue. Each PF is a mono component that is the result of an
envelope signal and a frequency modulated signal. In LMD a two-tier
method is utilized to perform the demodulation .First, the inner cycle
is used to conduct a thorough computation of the PF. Second, in the
outer cycle, the signal is decomposed depending on the iterations. In
the following sections the methods have been broken down into steps that
LMD technique requires to complete the analysis on a given signal x(t).
Consider the following synthetic signal <span class="math inline">\(x
(t)\)</span> of the form :</p>
</div>
<p><br></p>
<p><span class="math display">\[x ( t ) = 0.25t + sin ( πt ) + sin ( 2πt
) + sin ( 6πt )\]</span></p>
<p>The above signal is represented in graphical form below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fl">2000</span> <span class="co">#Sampling Frequency</span></span>
<span><span class="va">time_component</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">9</span>, by <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="va">fs</span><span class="op">)</span></span>
<span><span class="co"># Simulated Signal</span></span>
<span><span class="va">signal</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0.25</span> <span class="op">*</span> <span class="va">time_component</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">pi</span> <span class="op">*</span> <span class="va">time_component</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">time_component</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">6</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">time_component</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dummy_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Time <span class="op">=</span> <span class="va">time_component</span>, Value <span class="op">=</span> <span class="va">signal</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="va">dummy_df</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Value</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spline</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, colour <span class="op">=</span> <span class="st">"#1D2B71"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_hue</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fig 1. Sample Signal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Getting_Started_with_LMD_files/figure-html/unnamed-chunk-2-1.png" width="672px" height="480px" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="steps-for-pf-extraction">Steps for PF Extraction<a class="anchor" aria-label="anchor" href="#steps-for-pf-extraction"></a>
</h3>
<div class="section level4">
<h4 id="step-1">Step 1<a class="anchor" aria-label="anchor" href="#step-1"></a>
</h4>
<p>In the first step, all the local extrema <span class="math inline">\(n_i\)</span> are extracted from the original
signal <span class="math inline">\(x(t)\)</span>. The extreme values of
a signal can be found out by using the <code>find_extrema</code>
function from LMD.</p>
<pre><code><span><span class="fu">LMD</span><span class="fu">::</span><span class="fu"><a href="../reference/find_extrema.html">find_extrema</a></span><span class="op">(</span><span class="va">signal</span><span class="op">)</span></span></code></pre>
<p><code>find_extrema</code> function expects following parameters:</p>
<ul>
<li>
<code>signal</code>: Signal is a vector of numeric values</li>
<li>
<code>include_endpoints</code>: A logical value indicating whether
to include end points or not. Default value for this is set to
TRUE.</li>
</ul>
<p>The function returns indexes of all extreme values. In the below
chunk the extreme values of the original sample signal x(t) have been
indicated by red color.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">extreme_values</span> <span class="op">&lt;-</span> <span class="fu">LMD</span><span class="fu">::</span><span class="fu"><a href="../reference/find_extrema.html">find_extrema</a></span><span class="op">(</span><span class="va">signal</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spline</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dummy_df</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Value</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"#1D2B71"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dummy_df</span><span class="op">$</span><span class="va">Time</span><span class="op">[</span><span class="va">extreme_values</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">dummy_df</span><span class="op">$</span><span class="va">Value</span><span class="op">[</span><span class="va">extreme_values</span><span class="op">]</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>             colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_hue</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fig 2. Sifting Process: (1)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span></code></pre></div>
<p><img src="Getting_Started_with_LMD_files/figure-html/unnamed-chunk-3-1.png" width="672px" height="480px" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="step-2">Step 2<a class="anchor" aria-label="anchor" href="#step-2"></a>
</h4>
<p>In the second step the mean value <span class="math inline">\(m_i\)</span> is calculated by taking average of
the current extrema <span class="math inline">\(n_i\)</span> and the
next extrema <span class="math inline">\(n_{i+1}\)</span>. So the <span class="math inline">\(i_{th}\)</span> mean value <span class="math inline">\(m_i\)</span> of each two successive extrema <span class="math inline">\(n_i\)</span> and <span class="math inline">\(n_{i+1}\)</span> is given by:</p>
<p><span class="math display">\[ \begin{aligned} &amp;m_i =
{\frac{n_i+n_{i+1}}{2}} \\
\end{aligned} \]</span></p>
<p>All the mean values <span class="math inline">\(m_i\)</span> of two
successive extreme are connected by straight lines, as shown below:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">extreme_values</span> <span class="op">&lt;-</span> <span class="fu">LMD</span><span class="fu">::</span><span class="fu"><a href="../reference/find_extrema.html">find_extrema</a></span><span class="op">(</span><span class="va">signal</span><span class="op">)</span></span>
<span><span class="va">ma_enve</span> <span class="op">=</span> <span class="fu"><a href="../reference/local_mean_and_envelope.html">local_mean_and_envelope</a></span><span class="op">(</span><span class="va">signal</span>, <span class="va">extreme_values</span><span class="op">)</span></span>
<span><span class="va">mean</span> <span class="op">=</span> <span class="va">ma_enve</span><span class="op">$</span><span class="va">mean</span></span>
<span></span>
<span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spline</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dummy_df</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Value</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"#1D2B71"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dummy_df</span><span class="op">$</span><span class="va">Time</span><span class="op">[</span><span class="va">extreme_values</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">dummy_df</span><span class="op">$</span><span class="va">Value</span><span class="op">[</span><span class="va">extreme_values</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dummy_df</span><span class="op">$</span><span class="va">Time</span>, y <span class="op">=</span> <span class="va">mean</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_hue</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fig 3. Sifting Process: (2.1)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Getting_Started_with_LMD_files/figure-html/unnamed-chunk-4-1.png" width="672px" height="480px" style="display: block; margin: auto;"></p>
<p>The local mean function <span class="math inline">\(m_{11}(t)\)</span> is derived by taking a moving
weighted average of the means <span class="math inline">\(m_i\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">ma</span> <span class="op">=</span> <span class="va">ma_enve</span><span class="op">$</span><span class="va">ma</span></span>
<span></span>
<span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_spline</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dummy_df</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">Value</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"#1D2B71"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dummy_df</span><span class="op">$</span><span class="va">Time</span><span class="op">[</span><span class="va">extreme_values</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">dummy_df</span><span class="op">$</span><span class="va">Value</span><span class="op">[</span><span class="va">extreme_values</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    colour <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.5</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">dummy_df</span><span class="op">$</span><span class="va">Time</span>, y <span class="op">=</span> <span class="va">ma</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_hue</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fig 4. Sifting Process: (2.2) "</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p4</span><span class="op">)</span></span></code></pre></div>
<p><img src="Getting_Started_with_LMD_files/figure-html/unnamed-chunk-5-1.png" width="672px" height="480px" style="display: block; margin: auto;"></p>
<p>Similarly the envelope value<span class="math inline">\(a_i\)</span>
is given by:</p>
<p><span class="math display">\[ \begin{aligned} &amp;a_i =
{\frac{|n_i-n_{i+1}|}{2}} \\
\end{aligned} \]</span></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">envelope</span> <span class="op">=</span> <span class="va">ma_enve</span><span class="op">$</span><span class="va">enve</span></span>
<span><span class="va">Time</span><span class="op">=</span><span class="va">dummy_df</span><span class="op">$</span><span class="va">Time</span></span>
<span></span>
<span><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">envelope</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_hue</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fig 5. Sifting Process: (2.3)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p5</span><span class="op">)</span></span></code></pre></div>
<p><img src="Getting_Started_with_LMD_files/figure-html/unnamed-chunk-6-1.png" width="672px" height="480px" style="display: block; margin: auto;"></p>
<p>The envelope values <span class="math inline">\(a_i\)</span> are
smoothed using weighted moving average and the envelope function <span class="math inline">\(a_{11}\)</span>(t) is formed.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">enve_sm</span> <span class="op">=</span> <span class="va">ma_enve</span><span class="op">$</span><span class="va">enve_sm</span></span>
<span><span class="va">Time</span><span class="op">=</span><span class="va">dummy_df</span><span class="op">$</span><span class="va">Time</span></span>
<span><span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">envelope</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"red"</span>,alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">enve_sm</span><span class="op">)</span>,</span>
<span>            size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>            colour <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_hue</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fig 6. Sifting Process: (2.4) "</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">p6</span><span class="op">)</span></span></code></pre></div>
<p><img src="Getting_Started_with_LMD_files/figure-html/unnamed-chunk-7-1.png" width="672px" height="480px" style="display: block; margin: auto;"></p>
<p>The local mean and envelope and corresponding smoothed values can be
found out by using the <code>local_mean_and_envelope</code> function
from LMD.</p>
<pre><code><span><span class="fu">LMD</span><span class="fu">::</span><span class="fu"><a href="../reference/local_mean_and_envelope.html">local_mean_and_envelope</a></span><span class="op">(</span><span class="va">signal</span>, <span class="va">extrema</span><span class="op">)</span></span></code></pre>
<p><code>local_mean_and_envelope</code> function expects following
parameters:</p>
<ul>
<li>
<code>signal</code>: Signal is a vector of numeric values</li>
<li>
<code>extrema</code>: A vector of numeric values for indexes for
extreme values in the signal</li>
</ul>
<p>The function returns local mean, moving averaged local mean, envelope
and moving averaged local envelope values.</p>
</div>
<div class="section level4">
<h4 id="step-3">Step 3<a class="anchor" aria-label="anchor" href="#step-3"></a>
</h4>
<p>In the step 3 we calculate the zero-mean signal <span class="math inline">\(h_{11}\)</span>(t) by taking a difference of the
original signal <span class="math inline">\(x(t)\)</span> and the local
mean function <span class="math inline">\(m_{11}\)</span>(t) :</p>
<p><span class="math display">\[ \begin{aligned} &amp;h_{11}(t) =
{x(t)-m_{11}(t)} \\
\end{aligned} \]</span></p>
</div>
<div class="section level4">
<h4 id="step-4">Step 4<a class="anchor" aria-label="anchor" href="#step-4"></a>
</h4>
<p>Then, a frequency modulated signal <span class="math inline">\(s_{11}\)</span>(t) is calculated as:</p>
<p><span class="math display">\[ \begin{aligned} &amp;s_{11}(t) =
{h_{11}(t)/a_{11}(t)} \\
\end{aligned}  \]</span></p>
</div>
<div class="section level4">
<h4 id="step-5">Step 5<a class="anchor" aria-label="anchor" href="#step-5"></a>
</h4>
<p>Repeat the above steps 1 to 3 to get the envelope value <span class="math inline">\(a_{12}\)</span>(t) of <span class="math inline">\(s_{11}\)</span>(t) . This is the checkpoint for
the inner loop, if this envelope function <span class="math inline">\(a_{12}\)</span>(t) is equal to 1, the inner
iteration is stopped and <span class="math inline">\(s_{12}\)</span>(t)
is considered as the first purely frequency modulated (FM) signal. Else,
the <span class="math inline">\(s_{11}\)</span>(t) is considered as the
original signal and Steps 1 to 4 are repeated n times until the
condition <span class="math inline">\(a_{1(n+1)}\)</span>(t)=1 is
satisfied for signal <span class="math inline">\(s_{1(n)}\)</span>(t).</p>
</div>
<div class="section level4">
<h4 id="step-6">Step 6<a class="anchor" aria-label="anchor" href="#step-6"></a>
</h4>
<p>Calculate the envelope signal <span class="math inline">\(a_1\)</span>(t) of the first PF1 , multiply all
the smoothed local envelopes from the iterations:</p>
<p><span class="math display">\[ \begin{aligned} &amp; a_1(t) =
a_{11}(t) * a_{12}(t)*a_{13}(t)\dotso a_{1n}(t)  \\
\end{aligned} \]</span></p>
</div>
<div class="section level4">
<h4 id="step-7">Step 7<a class="anchor" aria-label="anchor" href="#step-7"></a>
</h4>
<p>Compute the first <span class="math inline">\(PF_1\)</span> using
<span class="math inline">\(a_{1}(t)\)</span> and <span class="math inline">\(s_{1n}(t)\)</span>:</p>
<p><span class="math display">\[\begin{aligned} &amp; PF_1 =
a_{1}(t)s_{1n}(t)  \\
\end{aligned} \]</span></p>
<p>Now the residual signal is given by <span class="math inline">\(u_1(t)\)</span> = <span class="math inline">\(x(t)\)</span>-<span class="math inline">\(PF_1(t)\)</span> . The residual <span class="math inline">\(u_1(t)\)</span> is considered as the original
signal and the above steps are repeated n times until <span class="math inline">\(u_n(t)\)</span> does not contain oscillation.</p>
<p>This is the called outer loop of LMD. Finally, the signal x(n) is
represented as a sum of PFs and residual signal:</p>
<p><span class="math display">\[\begin{aligned} &amp; x(n) =
\sum^q_{i=1}PF_i(n)+u_q(n)  \\
\end{aligned} \]</span></p>
<p>The LMD method can be applied on a signal by using the
<code>lmd</code> function from LMD Package.</p>
<pre><code><span><span class="fu">LMD</span><span class="fu">::</span><span class="fu"><a href="../reference/lmd.html">lmd</a></span><span class="op">(</span><span class="va">signal</span><span class="op">)</span></span></code></pre>
<p><code>lmd</code> function expects following parameters:</p>
<ul>
<li>
<code>signal</code>: Signal is a vector of numeric values</li>
<li>
<code>include_endpoints</code>: A boolean value indicating whether
to treat the endpoint of the signal as a pseudo-extreme point</li>
<li>
<code>max_smooth_iteration</code>: An integer value for maximum
number of iterations of moving average algorithm</li>
<li>
<code>max_envelope_iteration</code>: An integer value for maximum
number of iterations when separating local envelope signals</li>
<li>
<code>envelope_epsilon</code>: A float value to terminate processing
when obtaining pure FM signal</li>
<li>
<code>convergence_epsilon</code>: A float value to terminate
processing when modulation signal converges</li>
<li>
<code>max_num_pf</code>: An integer value for maximum number of PFs
to be generated</li>
</ul>
<p>The function returns PF and residual value as a list.</p>
</div>
</div>
<div class="section level3">
<h3 id="flowchart-of-lmd">Flowchart of LMD<a class="anchor" aria-label="anchor" href="#flowchart-of-lmd"></a>
</h3>
<p>A flowchart of the LMD method is presented in figure below for better
understanding. <br></p>
<div class="figure">
<img src="www/lmd_flowchart.png" width="700" alt=""><p class="caption">Figure 7: Flowchart of LMD</p>
</div>
<p><br></p>
</div>
</div>
<div class="section level2">
<h2 id="analysis-of-a-simulated-signal">Analysis of a simulated signal<a class="anchor" aria-label="anchor" href="#analysis-of-a-simulated-signal"></a>
</h2>
<p>In this section we will take a simulated multi-component AM–FM signal
x(t) and apply the LMD method on it. The time duration of the signal is
600s with sampling frequency of 1 Hz.</p>
<p><span class="math display">\[ \begin{align*}
x(t) &amp;= x_1(t) + x_2(t) \\
x_1(t) &amp;= [(1+0.5cos(πt/100))](cos(πt/2+2cos(πt/50))) \\
x_2(t) &amp;= 4sin(πt/2500)sin(6πt/50) \end{align*} \]</span></p>
<p>The plot below shows the time domain waveform for <span class="math inline">\(x(t)\)</span>, <span class="math inline">\(x_1(t)\)</span> and <span class="math inline">\(x_2(t)\)</span> respectively.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t</span><span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">600</span></span>
<span><span class="va">x1</span><span class="op">=</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">2</span><span class="op">+</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">x2</span><span class="op">=</span><span class="fl">4</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">2500</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">6</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">/</span><span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">=</span><span class="va">x1</span><span class="op">+</span><span class="va">x2</span></span>
<span></span>
<span><span class="va">Time</span><span class="op">=</span><span class="va">t</span></span>
<span><span class="va">combined_signal</span><span class="op">=</span><span class="va">y</span></span>
<span></span>
<span><span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">combined_signal</span><span class="op">)</span>,</span>
<span>                     size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     colour <span class="op">=</span> <span class="st">"midnightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"Combined Signal x(t)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The `size` argument of `element_rect()` is deprecated as of ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use the `linewidth` argument instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span></span>
<span><span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">x1</span><span class="op">)</span>,</span>
<span>                     size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     colour <span class="op">=</span> <span class="st">"midnightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"x1(t)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p9</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">x2</span><span class="op">)</span>,</span>
<span>                     size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     colour <span class="op">=</span> <span class="st">"midnightblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"x2(t)"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.border <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_rect</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">(</span><span class="va">p7</span><span class="op">/</span><span class="va">p8</span><span class="op">/</span><span class="va">p9</span><span class="op">)</span><span class="op">+</span> </span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fig 8. Simulated Signal"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Getting_Started_with_LMD_files/figure-html/unnamed-chunk-8-1.png" width="672px" height="480px" style="display: block; margin: auto;"></p>
<p><code>lmd</code> function is applied to decompose the simulation
signal x(t) by selecting <code>max_num_pf</code> as 2.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lmd_object</span><span class="op">=</span><span class="fu">LMD</span><span class="fu">::</span><span class="fu"><a href="../reference/lmd.html">lmd</a></span><span class="op">(</span><span class="va">combined_signal</span>,max_num_pf<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">PF1</span><span class="op">=</span><span class="va">lmd_object</span><span class="op">[[</span><span class="st">"pf"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">PF2</span><span class="op">=</span><span class="va">lmd_object</span><span class="op">[[</span><span class="st">"pf"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">residual_signal</span><span class="op">=</span><span class="va">lmd_object</span><span class="op">[[</span><span class="st">"residue"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>The decomposition results are presented in plot below using
<code>plot_lmd</code> function. <code>plot_lmd</code> function expects
following parameters:</p>
<ul>
<li>
<code>lmd_obj</code>: LMD object created from LMD function</li>
<li>
<code>max_pf</code>: Number of PFs to Plot</li>
<li>
<code>show_residue</code>: Whether to plot residue signal or
not</li>
<li>
<code>pricolor_plot</code>: Line color for plots</li>
<li>
<code>line_size_plot</code>: Size of line in ggplot</li>
</ul>
<p>The function returns a combined plot for PF and residual values.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_lmd.html">plot_lmd</a></span><span class="op">(</span><span class="va">lmd_object</span><span class="op">)</span><span class="op">+</span> </span>
<span>    <span class="fu">plot_annotation</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Fig 9. LMD Decompsition of Simulated Signal"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Getting_Started_with_LMD_files/figure-html/unnamed-chunk-10-1.png" width="672px" height="480px" style="display: block; margin: auto;"></p>
<p>In the plot above the product functions and the residual signal
obtained by decomposition of original signal is shown. The first product
function PF1(t) corresponds to constituent x1(t) and second product
function PF2 is the signal close to original constituent x2(t). PF1(t)
and PF2(t) are very close and similar to x1(t) and x2(t), respectively.
However, the residue signal contains some abnormal peaks, and the
corresponding disturbances can be seen in PFs as well, which shows that
the demodulation is close but not perfect. In the next section we
address these imperfections.</p>
</div>
<div class="section level2">
<h2 id="drawbacks-of-lmd">Drawbacks of LMD<a class="anchor" aria-label="anchor" href="#drawbacks-of-lmd"></a>
</h2>
<p>LMD shows great capability in demodulating amplitude and frequency
modulated signals. Be that as it may, it is noticeably flawed. It has
inadequacies, namely end effects and mode mixing. For better
understanding, these imperfections have been highlighted in the plot
that we received in above step(Fig 9). In Fig. 10, if we look closely at
the ends of residual signal, we can notice the first and the last value
deviating a lot from the rest of the signal, this effect is visible in
PFs also. This peculiarity is known as the end effect of LMD.
Furthermore, we can see some more deviations at around 500 s. This is
called mode mixing of LMD. <strong><em>To mitigate these issues, several
variations of LMD (like RLMD,IELMD,OLMD etc) have been proposed by
researchers, however, these methods have not been included in this
package.</em></strong></p>
<div class="figure">
<img src="www/drawback_lmd.png" width="700" alt=""><p class="caption">Figure 10: Drawbacks of LMD</p>
</div>
<p><br></p>
</div>
<div class="section level2">
<h2 id="applications">Applications<a class="anchor" aria-label="anchor" href="#applications"></a>
</h2>
<ul>
<li>Fault diagnosis for rotating machinery</li>
<li>Decomposition of EEG Signal</li>
</ul>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li>D. Kim and H.-S. Oh, “EMD: A package for empirical mode
decomposition and Hilbert spectrum,” The R Journal, 01-Jun-2009.
[Online]. Available: <a href="https://journal.r-project.org/articles/RJ-2009-002/" class="external-link uri">https://journal.r-project.org/articles/RJ-2009-002/</a>.
[Accessed: 17-Sep-2022]. J. Cheng, Y. Yang, and Y. Yang, “A rotating
machinery fault diagnosis method based on local mean decomposition,”
Digital Signal Processing, 19-Oct-2011. [Online]. Available: <a href="https://www.sciencedirect.com/science/article/pii/S1051200411001448" class="external-link uri">https://www.sciencedirect.com/science/article/pii/S1051200411001448</a>.
[Accessed: 17-Sep-2022].</li>
<li>“Review of local mean decomposition and its application in fault
diagnosis of rotating machinery,” IEEE Xplore. [Online]. Available: <a href="https://ieeexplore.ieee.org/document/8820748" class="external-link uri">https://ieeexplore.ieee.org/document/8820748</a>. [Accessed:
17-Sep-2022].</li>
<li>Y. Li, M. Xu, Z. Haiyang, Y. Wei, and W. Huang, “A new rotating
machinery fault diagnosis method based on improved local mean
decomposition,” Digital Signal Processing, 08-Jul-2015. [Online].
Available: <a href="https://www.sciencedirect.com/science/article/pii/S1051200415002213" class="external-link uri">https://www.sciencedirect.com/science/article/pii/S1051200415002213</a>.
[Accessed: 17-Sep-2022].</li>
<li>Z. Liu, Y. Jin, M. J. Zuo, and Z. Feng, “Time-frequency
representation based on robust local mean decomposition for
multicomponent AM-FM signal analysis,” Mechanical Systems and Signal
Processing, 10-Apr-2017. [Online]. Available: <a href="https://www.sciencedirect.com/science/article/pii/S0888327017301619" class="external-link uri">https://www.sciencedirect.com/science/article/pii/S0888327017301619</a>.
[Accessed: 17-Sep-2022].</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Shubhra Prakash.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
